## Common Commands

- `pnpm build` - Build the project
- `pnpm test` - Run all tests
- `pnpm lint` - Run linter
- `pnpm typecheck` - Type check with vue-tsc
- `pnpm format` - Format code with Prettier

## テスト駆動開発

t-wada の推奨するTDD を実施する。コードを生成するときは、それに対応するユニットテストを常に生成する。
コードを追加で修正したとき、`pnpm test` がパスすることを常に確認する。
vitest で実装と同じファイルにユニットテストを書く。

## カバレッジに基づくテスト生成

テストカバレッジ100%を目指す。

1. `pnpx vitest --run --coverage` を実行して、現在のカバレッジを取得
2. 今の状態から最もカバレッジが上がるテストコードを考察してから追加
3. 再度カバレッジを計測して、数値が向上していることを確認

ユーザーが満足するまで、テスト生成を繰り返す。

## 関数型ドメインモデリング

TypeScript で関数型ドメインモデリングを行う。class を使わず関数による実装を優先する。
代数的データでドメインをモデリングする。

- 純粋関数を優先
- 不変データ構造を使用
- 副作用を分離
- 型安全性を確保
- 値オブジェクトとエンティティを区別
- 集約で整合性を保証
- リポジトリでデータアクセスを抽象化
- 境界付けられたコンテキストを意識

## コメントによる自己記述

各ファイルの冒頭にはコメントで仕様を記述する。

## 内部で例外をスローしない

- `neverthrow`を使用して`Result<T, E>`を返す。
- 外部の throw は`neverthrow`の`fromThrowable`と`fromAsyncThrowable`を使用してラップする。
- `neverthrow`のメソッド(`match()`,`andThen()`)よりも TypeScript の言語機能(`isOk()`,`isErr()`)を優先する。

## 早期リターンパターンを使用して可読性を向上させる

- `else`文による深いネストを避ける。
- エラーケースを先に早期リターンで処理する。

## 単一責任と API の最小化

- ファイルは責務ごとに分割し、各ファイルが単一の責務を持つようにする。
- 公開 API は最小限に保ち、実装の詳細は隠蔽する。
- モジュールの境界と依存関係を最小化する。
- src/types.ts にアプリケーション内のドメインモデルを集約する。その型がどのように使われるかを jsdoc スタイルのコメントで記述する。
